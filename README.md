## jlink-restful-cpp-demo

Project generated by `ux`.

### cmake+ninja构建

### 环境准备

1. cmake(3.24+)  (必须)

2. ninja (必须)

3. 编译器

   Windows：vs2019+ (必须)

   Linux: gcc4.8.5 (必须)

   Android: ndkr21e (必须)

   IOS: iPhoneOS14.4.SDK (必须)
   
4. ssh-key (必须)

   项目构建过程中会拉取相关依赖库,所以对应的账号需要添加ssh-key支持

   推荐：`ssh-keygen -t ed25519`，密钥对默认生成在~/.ssh中，将公钥添加到gitlab账号中

   注意：tortoise git客户端不支持ssh-key，需要使用Putty Key 转换一下

   另外：拷贝的sshkey文件需要将私钥文件的权限修改成600才能使用

#### windows环境变量

```bash
# vs2019的安装目录，替换成自己的
VS160_INSTALL_DIR=C:\Program Files (x86)\Microsoft Visual Studio\2019\Professional
# vs2019依赖的windows sdk，一般都是这个目录
WINDOWS_SDK_DIR=C:\Program Files (x86)\Windows Kits\10
# windows sdk版本，与vs2019对应，10.0.19041.0
# cmake中已写死
```

#### android环境变量

```bash
# 1. ndk r21e
# 2. ninja
# 设置环境变量，替换成自己的
ANDROID_NDK_HOME=D:\tools\Android\android-ndk-r21e
PATH=D:\tools\Android\ninja;%PATH%
```

#### ios环境变量

```bash
# 设置环境变量，替换成自己的
IOS_SDK_HOME=/Users/zyj/Downloads/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS14.4.sdk
```

### 编译命令

```bash
cd jlink-restful-cpp-demo
mkdir build && cd build
# 构建支持的参数
# TARGET_OS: 目标平台名称，支持Windows,Android,Linux,Ios
# TARGET_ABI: 目标CPU架构，x86，x86_64，arm64，armeabi
# BUILD_TESTS: 是否编译集成测试,默认开启
# BUILD_DEMO: 是否编译demo，默认开启
# BUILD_SHARED_LIBS: 是否编译动态库,默认关闭
# BUILD_JNI: 是否编译JNI动态库,默认关闭
# BUILD_FRAMEWORK: 是否编译FRAMEWORK,默认关闭
# CMAKE_BUILD_TYPE: 构建类型，支持Debug，Release，默认Debug

# windows ninja方式
cmake .. -GNinja -DTARGET_OS=Windows -DTARGET_ABI=x86_64 -DBUILD_UNIT_TEST=ON -DBUILD_DEMO=ON -DBUILD_SHARED_LIBS=ON
ninja
# windows msbuild方式(生成solution)
cmake .. -A x64 -DBUILD_UNIT_TEST=ON -DBUILD_DEMO=ON -DBUILD_SHARED_LIBS=ON
cmake --build .

# android ninja方式
cmake .. -GNinja -DTARGET_OS=Android -DTARGET_ABI=arm64 -DCMAKE_BUILD_TYPE=Release
ninja

# linux ninja方式
cmake .. -GNinja -DTARGET_OS=Linux -DTARGET_ABI=x86_64 -DCMAKE_BUILD_TYPE=Release
ninja

# ios ninja方式
cmake .. -GNinja -DTARGET_OS=Ios -DTARGET_ABI=arm64 -DCMAKE_BUILD_TYPE=Release
ninja

# ios xcode方式
cmake .. -GXcode -DTARGET_OS=Ios -DTARGET_ABI=arm64 -DCMAKE_BUILD_TYPE=Release
ninja
```




